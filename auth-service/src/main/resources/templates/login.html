<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>CloudCrush | Login</title>
</head>
<body style="margin:0; padding:0; font-family:'Segoe UI',sans-serif; background:linear-gradient(135deg,#89f7fe,#66a6ff); height:100vh; display:flex; align-items:center; justify-content:center;">

<div style="background:white; width:380px; border-radius:15px; padding:30px; box-shadow:0 4px 20px rgba(0,0,0,0.2); text-align:center;">
    <h1 style="font-size:24px; font-weight:bold; color:#007BFF; margin-bottom:5px;">‚òÅÔ∏è CLOUDCRUSH</h1>
    <p style="margin:0; font-size:13px; color:#555;">_Your personal alternative to Google Drive_</p>
    <p style="margin:0; font-size:12px; color:#777;">Because documents and memories both are important</p>
    <p style="font-size:11px; color:#999; margin-top:5px;">Founded by <strong>Nandini Sharma</strong></p>
    <hr style="margin:15px 0; border:none; height:1px; background:#eee;">

    <form id="loginForm">
        <input type="email" id="email" placeholder="Email" required
               style="width:90%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:8px;"><br>
        <input type="password" id="password" placeholder="Password" required
               style="width:90%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:8px;"><br>
        <button type="submit"
                style="background:#007BFF; color:white; border:none; padding:10px 25px; border-radius:8px; cursor:pointer; margin-top:10px; width:95%;">Login</button>
    </form>

    <p id="loginMessage" style="color:red; font-size:13px; margin-top:10px;"></p>

    <p style="font-size:14px; margin-top:20px;">New here?
        <a th:href="@{/register}" style="color:#007BFF; text-decoration:none;">Create account</a>
    </p>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("loginForm");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        try {
          const res = await fetch("/api/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password })
          });

          if (!res.ok) throw new Error("Invalid login");
          const data = await res.json();
          localStorage.setItem("jwtToken", data.token);
          alert("Welcome back to CloudCrush üå•Ô∏è");
          window.location.href = "/dashboard?token=" + data.token;
        } catch {
          document.getElementById("loginMessage").textContent = "Invalid email or password!";
        }
      });
    });
</script
</body>
</html>
